
<!DOCTYPE html>
<html>
  <head>
    <title>Plant a tree</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.2/p5.js"></script>
    <script src="collide.js"></script>
    <script>
      function setup() {
      createCanvas(windowWidth - 20, windowHeight - 20)
      dots = []
      specialDot = new bouncyBall()
      dots.push(specialDot)
      for (i = 0; i < 100; i++) {
        dots.push(new bouncyBall())
      }
      colorMode(HSL, 360, 100, 100)
      myColor = random(360)
      spread = 30
    }

    function draw() {
      background(220, 0, 80)
      dots.forEach( dot => {
        //dot.puff()
        dot.move()
        dot.display()
        dot.checkCollision()
      })
      fill(myColor,80,70)
      ellipse(mouseX, mouseY, spread)
      if (collideCircleCircle(mouseX, mouseY, 30, specialDot.x, specialDot.y, specialDot.r * 2)) {
        console.log("collision!!!!!!")
      }
      //console.log(specialDot.x, specialDot.y, specialDot.r)
    }

    class bouncyBall {
      constructor() {
        this.x = random(width)
        this.y = random(height)
        this.r = random(5,12)
        this.maxR = 20
        this.minR = 5
        this.growthDirection = 1
        this.growthRate = 0.1
        this.color = random(360)
        this.masterXvelocity = random(0.5, 3)
        this.masterYvelocity = random(0.5, 3)
        this.xVelocity = this.masterXvelocity
        this.yVelocity = this.masterYvelocity
        if (random(-1, 1) > 0) {
          this.xVelocity = this.xVelocity * -1
        }
        if (random(-1, 1) > 0) {
          this.yVelocity = this.yVelocity * -1
        }
      }

      puff() {
        if (random(0, 1) < 0.05) {
          this.growthDirection = this.growthDirection * -1
        }
        if (this.r > this.maxR) {
          this.growthDirection = -1 * abs(this.growthDirection)
        } else if (this.r < this.minR) {
          this.growthDirection = abs(this.growthDirection)
        }
        this.r += this.growthDirection * this.growthRate
      }

      move() {
        this.x += this.xVelocity
        this.y += this.yVelocity
        if (this.x + this.r > width) {
          this.xVelocity = -1 * this.masterXvelocity
        }
        if (this.x - this.r < 0) {
          this.xVelocity = this.masterXvelocity
        }
        if (this.y + this.r > height) {
          this.yVelocity = -1 * this.masterYvelocity
        }
        if (this.y - this.r < 0) {
          this.yVelocity = this.masterYvelocity
        }
      }

      display() {
        this.color = (this.color + random(0, 1.2)) % 360
        fill(this.color, 80, 70)
        noStroke()
        ellipse(this.x, this.y, this.r * 2)
      }
      
      checkCollision() {
        if (collideCircleCircle(this.x, this.y, this.r*2, mouseX, mouseY, spread)) {
          spread += sqrt(this.r)
          myColor = myColor > this.color ? myColor + 8 : myColor - 8
          // Need code to move in the direction that is shortest distance.
          dots.splice(dots.indexOf(this), 1)
          console.log(myColor)
        }
      }
    }
    </script>
    <style> body {padding: 0; margin: 0;} </style>
  </head>
  <body>
  </body>
</html>
